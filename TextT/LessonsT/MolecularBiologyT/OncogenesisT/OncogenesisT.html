<!--
* Setup Menu Groups
    - Control horizontal levels with <br> elements
    - linksLarge for main topics, linkSmall for subtopics,
    - Enter "linkNames"
    - Remember, menu# must be sequential, timestamps for each defined in JS & src_array
-->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="OncogenesisT" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="author" content="Jack D. Thatcher, Ph.D., West Virginia School of Osteopathic Medicine" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="../../../../CommonFiles/MasterMolecularBiology.css">
    <link rel="stylesheet" href="../../../../CommonFiles/MasterLessons.css">
    <link rel="stylesheet" href="../../../../CommonFiles/LessonSpecificStylesheets/Oncogenesis.css">
    <title>Oncogenesis</title>
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-storage-compat.js"></script>
</head>

<body>
    <div class="entireLesson">            <!-- Lesson Container, Menu and Animation -->
        <div class="lessonMenuPage" id="lessonMenuPage" onclick="nextSlide()">    <!-- Container for Menu & Footer -->

            <header>
                <h1>Oncogenesis</h1>
            </header>
            <div class="viScript">
                <a onclick='executeClickNewWindow("viOncogenesis.html")'>Script for the Visually Impaired</a>
            </div>

            <!-- Header Button Bank -->
            <div class="headBank">
                <img class="btnHeader" id="btnToCentralMenu" src="../../../../CommonFiles/Buttons/BTN_ToCentralMenu.jpg" onclick="self.location.href='../../../CentralMenuT.html'"><span class="sr-only">Return to Main Menu</span>
                <img class="btnHeader" id="btnTogTextLessonMenuX" src="../../../../CommonFiles/Buttons/BTN_TogLessonMenuX.jpg" onclick="self.location.href='../../../../TextX/LessonsX/MolecularBiologyX/OncogenesisX/OncogenesisX.html'"><span class="sr-only">Hide Explanatory Text</span>
                <img class="btnHeader" id="btnToPopUps" src="../../../../CommonFiles/Buttons/BTN_PopUp.jpg" onclick='executeClick("PopUpsOncogenesisT.html")'><span class="sr-only">Pop Ups</span>
                <img class="btnHeader" id="btnExcerpts" src="../../../../CommonFiles/Buttons/BTN_Excerpts.jpg" onclick='executeClick("ExcerptsOncogenesisT.html")'><span class="sr-only">Excerpts</span>
                <img class="btnHeader" id="btnQuestions" src="../../../../CommonFiles/Buttons/BTN_Questions.jpg" onclick="self.location.href='QuestionsOncogenesisT.html'"><span class="sr-only">Practice Questions</span>
                <img class="btnHeader" id="btnFeedback" src="../../../../CommonFiles/Buttons/BTN_Feedback.jpg" onclick="self.location.href='FeedbackOncogenesisT.html'"><span class="sr-only">Provide Feedback</span>
            </div>

            <!-- Lesson Menu -->
            <div class="lessonMenu">
                <div class="group1">
                    <ul class="menuLists">
                        <li><button id="menu1" class="linksLarge">Introduction</button></li>
                        <li><button id="menu2" class="linksLarge">Transformation</button></li>
                        <li><button id="menu3" class="linksLarge">Metastasis</button></li>
                        <li><button id="menu4" class="linksLarge">Clonal Model</button></li>
                        <li><button id="menu5" class="linksLarge">Multi-Hit Model</button></li>
                        <li><button id="menu6" class="linksLarge">Carcinogenic Genes</button></li>
                        <li><button id="menu7" class="linksLarge">Oncogenes</button></li>
                        <li><button id="menu8" class="linksLarge">Tumor Suppressors</button></li>
                        <li><button id="menu9" class="linksLarge">Two Hit Model</button></li>
                        <li><button id="menu10" class="linksLarge">Chromosomal Aberrations</button></li>
                        <li><button id="menu11" class="linksLarge">Gene Amplifications</button></li>
                        <li><button id="menu12" class="linksLarge">Chromosome Instability Syndromes</button>
                    </ul>
                </div>
            </div>

            <!-- Footer -->
            <div class="footerLinks">
                <a href="CitationsOncogenesisT.html">Citations</a>
            </div>
        </div>

        <!-- Lesson -->
        <div id="lesson" class="lesson">
            <div class="animation" id="animation" onclick="nextSlide()">
                <video class="video" id="videoId">
				    Video tag not supported
                </video>
            </div>
            <div class="lessonButtons">
                <img class="btnFooter" id="btnLessonMenu" src="../../../../CommonFiles/Buttons/BTN_LessonMenu.jpg" onclick="self.location.href='OncogenesisT.html'">
                <img class="btnFooter" id="btnBack" src="../../../../CommonFiles/Buttons/BTN_Back.jpg">
                <img class="btnFooter btnRate" id="btnSlower" src="../../../../CommonFiles/Buttons/BTN_Slow.jpg" onclick="slowDown('videoId')">
                <img class="btnFooter btnRate" id="btnFaster" src="../../../../CommonFiles/Buttons/BTN_Fast.jpg" onclick="speedUp('videoId')">
            </div>
        </div>
    </div>
</body>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script>
    // Initialize Firebase
    const firebaseConfig = {
        apiKey: "AIzaSyB0KbGW-4znfF19ikrUahdCyd_bEungkH4",
        authDomain: "biome-865cc.firebaseapp.com",
        projectId: "biome-865cc",
        storageBucket: "biome-865cc.firebasestorage.app",
        messagingSenderId: "952652458408",
        appId: "1:952652458408:web:23e7f0689e9cf973be959d"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // Load srcArray from Firestore
    async function loadSrcArray(lessonId) {
        const doc = await db.collection("lessons").doc(lessonId).get();
        if (!doc.exists) {
            console.error("Lesson not found:", lessonId);
            return [];
        }
        return doc.data().srcArray;
    }

    // Load video URL from Firebase Storage
    async function loadVideoUrl(lessonId) {
        const storageRef = firebase.storage().ref();
        const fileRef = storageRef.child(`videos/${lessonId}.mp4`);
        return fileRef.getDownloadURL();
    }

    // Load masterUIcontrol.js first
    const masterUIScript = document.createElement('script');
    masterUIScript.src = '../../../../CommonFiles/masterUIcontrol.js';
    document.body.appendChild(masterUIScript);
    
    masterUIScript.onload = function() {
        // Load srcArray from Firestore and initialize player
        (async () => {
            const lessonId = "oncogenesis_t";

            const srcArray = await loadSrcArray(lessonId);
            const videoUrl = await loadVideoUrl(lessonId);

            console.log("Loaded timing array:", srcArray);
            console.log("Loaded video URL:", videoUrl);

            initializePlayer(videoUrl, srcArray);

            // Load lesson-specific script
            const lessonScript = document.createElement('script');
            lessonScript.src = 'OncogenesisT.js';
            document.body.appendChild(lessonScript);
        })();
    };
</script>
</html>
